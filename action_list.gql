# ================================================================
# ACTION & ACTIONLIST â€“ COMPLETE SCHEMA EXTRACT
# ================================================================

type Action @aws_api_key @aws_iam {
  id: ID!
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
  _version: Int!
  _deleted: Boolean
  _lastChangedAt: AWSTimestamp

  actionlistID: ID!
  knowledgeBaseID: ID

  ActionItem: String
  prompt: String
  ActionStatus: Status
  Due_date: AWSDateTime
  orderRank: Int

  Accepted: Boolean
  Delegate: Boolean
  Ignore: Boolean
  Encrypt: Boolean
  isImportant: Boolean
  isUrgent: Boolean

  Owner: String
  Type: String
  Notify: String
  Notes: [String]
  Tags: [String]
  KBLink: [String]
  FileUrls: [String]
  GuardRails: AWSJSON
  History: AWSJSON
  userLike: Int

  assignedUserInfo: ActionListTransferUserInfo
  assignedByUserInfo: ActionListTransferUserInfo

  Conversations(
    filter: ModelConversationFilterInput
    limit: Int
    nextToken: String
    sortDirection: ModelSortDirection
  ): ModelConversationConnection
}

type ActionList @aws_api_key @aws_iam {
  id: ID!
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
  _version: Int!
  _deleted: Boolean
  _lastChangedAt: AWSTimestamp

  actionboardID: ID
  knowledgeBaseID: ID
  savedBy: String

  action: String
  Context: String
  notes: String
  Tags: [String]
  DueDate: AWSDateTime
  orderRank: Int

  actionListStatus: Status
  Delegate: Boolean
  Ignore: Boolean
  isImportant: Boolean
  isUrgent: Boolean

  metadata: ActionListMetaData
  transferInfo: TransferInfo

  assignedUserInfo: ActionListTransferUserInfo
  assignedByUserInfo: ActionListTransferUserInfo

  actionItems(
    filter: ModelActionFilterInput
    limit: Int
    nextToken: String
    sortDirection: ModelSortDirection
  ): ModelActionConnection
}

type ActionListMetaData {
  mainBoardId: ID
  newBoardId: ID
}

type ActionListTransferUserInfo {
  id: ID!
  name: String
  email: String!
  avatar: String
}

type TransferInfo {
  transferStatus: TransferStatus
  transferRequestByUserInfo: ActionListTransferUserInfo
  transferAcceptByUserInfo: ActionListTransferUserInfo
  transferRejectByUserInfo: ActionListTransferUserInfo
  transferRequestTime: AWSDateTime
  transferAcceptTime: AWSDateTime
  transferRejectTime: AWSDateTime
}

type SimpleResponse {
  success: Boolean!
  message: String!
}

type ModelActionConnection {
  items: [Action]!
  nextToken: String
  startedAt: AWSTimestamp
}

type ModelActionListConnection {
  items: [ActionList]!
  nextToken: String
  startedAt: AWSTimestamp
}

enum Status {
  Active
  Done
  In_Progress
  New
  Todo
  AutoActionAiAgent
  ActionAssistAgent
}

enum ActionListOrItemType {
  ACTION_LIST
  ACTION_ITEM
}

enum TransferStatus {
  REQUESTED
  ACCEPTED
  REJECTED
}

# ================================================================
# QUERIES
# ================================================================

extend type Query {
  getAction(id: ID!): Action
  getActionList(id: ID!): ActionList

  getAction_test(id: ID!): Action
  getActionByActionlistID_test(actionlistID: ID!): [Action]
  getSharedActionlistByBoardId(boardId: ID!): ActionListResponse

  listActions(
    filter: ModelActionFilterInput
    limit: Int
    nextToken: String
  ): ModelActionConnection

  listActionLists(
    filter: ModelActionListFilterInput
    limit: Int
    nextToken: String
  ): ModelActionListConnection

  actionsByActionlistID(
    actionlistID: ID!
    filter: ModelActionFilterInput
    limit: Int
    nextToken: String
    sortDirection: ModelSortDirection
  ): ModelActionConnection

  actionsByKnowledgeBaseID(
    knowledgeBaseID: ID!
    filter: ModelActionFilterInput
    limit: Int
    nextToken: String
    sortDirection: ModelSortDirection
  ): ModelActionConnection

  actionListsByActionboardID(
    actionboardID: ID!
    filter: ModelActionListFilterInput
    limit: Int
    nextToken: String
    sortDirection: ModelSortDirection
  ): ModelActionListConnection

  actionListsByKnowledgeBaseID(
    knowledgeBaseID: ID!
    filter: ModelActionListFilterInput
    limit: Int
    nextToken: String
    sortDirection: ModelSortDirection
  ): ModelActionListConnection

  actionListsBySavedBy(
    savedBy: String!
    filter: ModelActionListFilterInput
    limit: Int
    nextToken: String
    sortDirection: ModelSortDirection
  ): ModelActionListConnection

  syncActions(
    filter: ModelActionFilterInput
    lastSync: AWSTimestamp
    limit: Int
    nextToken: String
  ): ModelActionConnection

  syncActionLists(
    filter: ModelActionListFilterInput
    lastSync: AWSTimestamp
    limit: Int
    nextToken: String
  ): ModelActionListConnection
}

# ================================================================
# MUTATIONS
# ================================================================

extend type Mutation {
  createAction(input: CreateActionInput!): Action
  updateAction(input: UpdateActionInput!): Action
  deleteAction(id: ID!): Action
  deleteAction_test(actionId: ID!): Boolean

  deleteActionsByActionListID(id: ID!): Boolean
  deleteActionsByActionListID_test(id: ID!): Boolean

  createActionList(input: CreateActionListInput!): ActionList
  updateActionList(input: UpdateActionListInput!): ActionList
  deleteActionList(id: ID!): ActionList
  deleteActionListWithItems(id: ID!): Boolean  # List + all its actions

  transferActionListRequest(input: ActionListTransferInput!): SimpleResponse
  acceptTransferActionListRequest(input: ActionListTransferAcceptRejectInput!): SimpleResponse
  rejectTransferActionListRequest(input: ActionListTransferAcceptRejectInput!): SimpleResponse
  assignUserInActionListOrItem(input: AssignUserInActionListOrItemInput!): SimpleResponse
}

# ================================================================
# SUBSCRIPTIONS
# ================================================================

extend type Subscription {
  onCreateAction(filter: ModelSubscriptionActionFilterInput): Action @aws_subscribe(mutations: ["createAction"])
  onUpdateAction(filter: ModelSubscriptionActionFilterInput): Action @aws_subscribe(mutations: ["updateAction"])
  onDeleteAction(filter: ModelSubscriptionActionFilterInput): Action @aws_subscribe(mutations: ["deleteAction"])

  onCreateActionList(filter: ModelSubscriptionActionListFilterInput): ActionList @aws_subscribe(mutations: ["createActionList"])
  onUpdateActionList(filter: ModelSubscriptionActionListFilterInput): ActionList @aws_subscribe(mutations: ["updateActionList"])
  onDeleteActionList(filter: ModelSubscriptionActionListFilterInput): ActionList @aws_subscribe(mutations: ["deleteActionList"])
}

# ================================================================
# INPUT TYPES (Create / Update / Delete)
# ================================================================

input CreateActionInput {
  actionlistID: ID!
  ActionItem: String
  prompt: String
  ActionStatus: Status
  Due_date: AWSDateTime
  orderRank: Int
  Accepted: Boolean
  Delegate: Boolean
  Ignore: Boolean
  Encrypt: Boolean
  isImportant: Boolean
  isUrgent: Boolean
  Owner: String
  Type: String
  Notify: String
  Notes: [String]
  Tags: [String]
  KBLink: [String]
  FileUrls: [String]
  GuardRails: AWSJSON
  History: AWSJSON
  knowledgeBaseID: ID
  userLike: Int
  _version: Int
  id: ID
}

input UpdateActionInput {
  id: ID!
  actionlistID: ID
  ActionItem: String
  prompt: String
  ActionStatus: Status
  Due_date: AWSDateTime
  orderRank: Int
  Accepted: Boolean
  Delegate: Boolean
  Ignore: Boolean
  Encrypt: Boolean
  isImportant: Boolean
  isUrgent: Boolean
  Owner: String
  Type: String
  Notify: String
  Notes: [String]
  Tags: [String]
  KBLink: [String]
  FileUrls: [String]
  GuardRails: AWSJSON
  History: AWSJSON
  knowledgeBaseID: ID
  userLike: Int
  _version: Int
}

input CreateActionListInput {
  actionboardID: ID
  action: String
  Context: String
  notes: String
  Tags: [String]
  DueDate: AWSDateTime
  orderRank: Int
  actionListStatus: Status
  Delegate: Boolean
  Ignore: Boolean
  isImportant: Boolean
  isUrgent: Boolean
  knowledgeBaseID: ID
  savedBy: String
  _version: Int
  id: ID
}

input UpdateActionListInput {
  id: ID!
  actionboardID: ID
  action: String
  Context: String
  notes: String
  Tags: [String]
  DueDate: AWSDateTime
  orderRank: Int
  actionListStatus: Status
  Delegate: Boolean
  Ignore: Boolean
  isImportant: Boolean
  isUrgent: Boolean
  knowledgeBaseID: ID
  savedBy: String
  _version: Int
}

input DeleteActionInput {
  id: ID!
}

input DeleteActionListInput {
  id: ID!
}

input ActionListTransferInput {
  actionListId: ID!
  userId: ID!
  newBoardId: ID!
}

input ActionListTransferAcceptRejectInput {
  actionListId: ID!
  userId: ID!
}

input AssignUserInActionListOrItemInput {
  actionLisOrItemId: ID!
  assignedUserId: ID!
  assignedByUserId: ID!
  type: ActionListOrItemType!
}